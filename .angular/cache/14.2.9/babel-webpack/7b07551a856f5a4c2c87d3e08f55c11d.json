{"ast":null,"code":"import { YELLOW_COMPLETION_STYLES, GREEN_COMPLETION_STYLES, BLUE_COMPLETION_STYLES } from \"./app.constants\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { AuthenticationService } from \"./auth/authentication.service\";\nimport { TimeService } from \"./services/data/time.service\";\nimport { ErrorService } from \"./services/data/error.service\";\nimport { WeekDay } from \"@angular/common\";\nimport { FormGroup, FormControl, Validators } from \"@angular/forms\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./auth/authentication.service\";\nimport * as i3 from \"./services/data/time.service\";\nimport * as i4 from \"./services/data/error.service\";\nexport let TaskIndexNewComponent = /*#__PURE__*/(() => {\n  class TaskIndexNewComponent {\n    constructor(route, taskServiceInterface, authService, timeService, router, errorService, target, indexData) {\n      this.route = route;\n      this.taskServiceInterface = taskServiceInterface;\n      this.authService = authService;\n      this.timeService = timeService;\n      this.router = router;\n      this.errorService = errorService;\n      this.index = 0;\n      this.yellow_completion_styles = YELLOW_COMPLETION_STYLES;\n      this.green_completion_styles = GREEN_COMPLETION_STYLES;\n      this.blue_completion_styles = BLUE_COMPLETION_STYLES;\n      this.target = target;\n      this.indexData = indexData;\n    }\n\n    ngOnInit() {\n      // Get date from URL\n      this.route.params.subscribe(params => {\n        this.month = +params[\"month\"];\n        this.year = +params[\"year\"];\n      }); // Prepare day number and week day arrays\n\n      this.prepareMonthDaysArray();\n      this.today = new Date().getDay();\n      this.date = new Date();\n      this.today = this.timeService.getActiveDay(this.month, this.year, this.date);\n      this.username = this.authService.getAuthenticatedUser();\n      this.returnUrl = \"/\" + this.target + \"/\" + this.year + \"/\" + this.month;\n      this.taskServiceInterface.getTaskIndexData(this.username, this.target, this.year, this.month).subscribe(data => {\n        this.indexData = data;\n        this.processData();\n      }, error => {\n        this.errorService.displayMessage(error, this.returnUrl);\n      });\n      this.initForm();\n    }\n\n    onSubmit() {\n      this.year = this.selectDate.value.selectYear;\n      this.month = this.selectDate.value.selectMonth;\n      this.prepareMonthDaysArray(); // clear index data\n\n      this.today = this.timeService.getActiveDay(this.month, this.year, this.date);\n      this.taskServiceInterface.getTaskIndexData(this.username, this.target, this.year, this.month).subscribe(data => {\n        this.indexData = data;\n        this.processData();\n      }, error => {\n        this.errorService.displayMessage(error, this.returnUrl);\n      });\n      this.router.navigate([\"/\" + this.target + \"/\" + this.year + \"/\" + this.month]);\n    }\n\n    prepareMonthDaysArray() {\n      this.lengthOfMonth = new Date(this.year, this.month, 0).getDate();\n      this.monthDaysArr = Array(this.lengthOfMonth).fill(0).map((x, i) => i + 1);\n      this.weekDayArr = Array(this.lengthOfMonth).fill(0).map((x, i) => WeekDay[new Date(this.year, this.month - 1, i + 1).getDay()]);\n    }\n\n    onAddExtraordinaryClick(year, month, day) {\n      this.router.navigate([\"/extraordinary/\" + year + \"/\" + month + \"/\" + day + \"/new\"]);\n    }\n\n    onEditExtraordinaryClick(id) {\n      this.router.navigate([\"/extraordinary/\" + id + \"/edit\"]);\n    }\n\n    onAddNewClick(target, num, year, month, day) {\n      this.router.navigate([\"/\" + target + \"/\" + num + \"/\" + year + \"/\" + month + \"/\" + day + \"/new\"], {\n        replaceUrl: false\n      });\n    }\n\n    onEditClick(target, num, id) {\n      this.router.navigate([\"/\" + target + \"/\" + num + \"/\" + id + \"/edit\"]);\n    }\n\n    onAddDayClick(year, month, day) {\n      this.router.navigate([\"/days/\" + year + \"/\" + month + \"/\" + day + \"/new\"]);\n    }\n\n    onEditDayClick(id) {\n      this.router.navigate([\"/days/\" + id + \"/edit\"]);\n    }\n\n    initForm() {\n      const selectYear = this.year;\n      const selectMonth = this.month;\n      this.selectDate = new FormGroup({\n        selectYear: new FormControl(selectYear, Validators.required),\n        selectMonth: new FormControl(selectMonth, Validators.required)\n      });\n    }\n\n  }\n\n  TaskIndexNewComponent.ɵfac = function TaskIndexNewComponent_Factory(t) {\n    i0.ɵɵinvalidFactory();\n  };\n\n  TaskIndexNewComponent.ɵdir = /*@__PURE__*/i0.ɵɵdefineDirective({\n    type: TaskIndexNewComponent,\n    inputs: {\n      index: \"index\"\n    }\n  });\n  return TaskIndexNewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}